<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search Places</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 50px;
        }

        h1 {
            color: #333;
        }

        #form-container {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            gap: 20px;
        }

        select, input, button {
            padding: 10px;
            font-size: 16px;
            width: 300px;
        }

        #results {
            margin-top: 30px;
        }
    </style>
</head>
<body>
    <h1>Search for Places and Get Headquarters Info</h1>

    <div id="form-container">
        <form id="query-form">
            <label for="query">Upload Query File:</label>
            <input type="file" id="query" name="query">
            
            <label for="region">Select Region/Country:</label>
            <select id="region" name="region">
                <option value="US">ğŸ‡ºğŸ‡¸ United States</option>
                <option value="GB">ğŸ‡¬ğŸ‡§ United Kingdom</option>
                <option value="CA">ğŸ‡¨ğŸ‡¦ Canada</option>
                <option value="AU">ğŸ‡¦ğŸ‡º Australia</option>
                <option value="DE">ğŸ‡©ğŸ‡ª Germany</option>
                <option value="FR">ğŸ‡«ğŸ‡· France</option>
                <option value="IT">ğŸ‡®ğŸ‡¹ Italy</option>
                <option value="JP">ğŸ‡¯ğŸ‡µ Japan</option>
                <option value="CN">ğŸ‡¨ğŸ‡³ China</option>
                <option value="IN">ğŸ‡®ğŸ‡³ India</option>
                <option value="BR">ğŸ‡§ğŸ‡· Brazil</option>
                <option value="MX">ğŸ‡²ğŸ‡½ Mexico</option>
                <option value="RU">ğŸ‡·ğŸ‡º Russia</option>
                <option value="ZA">ğŸ‡¿ğŸ‡¦ South Africa</option>
                <option value="KR">ğŸ‡°ğŸ‡· South Korea</option>
                <option value="ES">ğŸ‡ªğŸ‡¸ Spain</option>
                <option value="SE">ğŸ‡¸ğŸ‡ª Sweden</option>
                <option value="CH">ğŸ‡¨ğŸ‡­ Switzerland</option>
                <option value="NL">ğŸ‡³ğŸ‡± Netherlands</option>
                <option value="BE">ğŸ‡§ğŸ‡ª Belgium</option>
                <option value="DK">ğŸ‡©ğŸ‡° Denmark</option>
                <option value="NO">ğŸ‡³ğŸ‡´ Norway</option>
                <option value="FI">ğŸ‡«ğŸ‡® Finland</option>
                <option value="PL">ğŸ‡µğŸ‡± Poland</option>
                <option value="PT">ğŸ‡µğŸ‡¹ Portugal</option>
                <option value="GR">ğŸ‡¬ğŸ‡· Greece</option>
                <option value="AR">ğŸ‡¦ğŸ‡· Argentina</option>
                <option value="CO">ğŸ‡¨ğŸ‡´ Colombia</option>
                <option value="CL">ğŸ‡¨ğŸ‡± Chile</option>
                <option value="NG">ğŸ‡³ğŸ‡¬ Nigeria</option>
                <option value="KE">ğŸ‡°ğŸ‡ª Kenya</option>
                <option value="SA">ğŸ‡¸ğŸ‡¦ Saudi Arabia</option>
                <option value="TR">ğŸ‡¹ğŸ‡· Turkey</option>
                <option value="EG">ğŸ‡ªğŸ‡¬ Egypt</option>
                <option value="TH">ğŸ‡¹ğŸ‡­ Thailand</option>
                <option value="SG">ğŸ‡¸ğŸ‡¬ Singapore</option>
                <option value="MY">ğŸ‡²ğŸ‡¾ Malaysia</option>
                <option value="ID">ğŸ‡®ğŸ‡© Indonesia</option>
                <!-- Add more countries if needed -->
            </select>

            <button type="button" id="run-button">Run Search</button>
        </form>

        <!-- The download button will appear after the search -->
        <button id="download-csv" style="display: none;">Download Results as CSV</button>

        <!-- Result section -->
        <div id="results"></div>
    </div>

    <script>
        document.getElementById('run-button').addEventListener('click', function () {
            let formData = new FormData();
            let queryFile = document.getElementById('query').files[0];
            let region = document.getElementById('region').value;

            formData.append('query', queryFile);
            formData.append('region', region);

            fetch('/run-search', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    // Show the download CSV button when results are ready
                    document.getElementById('download-csv').style.display = 'block';

                    // Show results in a div (if you want to display in the UI)
                    document.getElementById('results').innerHTML = '<h2>Results:</h2>' + JSON.stringify(data.results, null, 2);
                } else {
                    alert('Error: ' + data.message);
                }
            });
        });

        // Add functionality to download CSV when the button is clicked
        document.getElementById('download-csv').addEventListener('click', function () {
            window.location.href = '/download-csv';
        });
    </script>
</body>
</html>
