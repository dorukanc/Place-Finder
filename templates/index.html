<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Place Finder</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <style>
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        .animate-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
    </style>
</head>
<body class="h-full flex flex-col bg-gray-100">
    <main class="flex-grow flex items-center justify-center px-4 py-12">
        <div class="bg-white p-8 rounded-lg shadow-md w-full max-w-md">
            <h1 class="text-2xl font-bold mb-6 text-center">Place Finder</h1>
            <form id="search-form" class="space-y-4">
                <div>
                    <label for="query" class="block text-sm font-medium text-gray-700">Upload Query File:</label>
                    <input type="file" id="query" name="query" accept=".txt" required class="mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                </div>
                <div>
                    <label for="location" class="block text-sm font-medium text-gray-700">Select Location:</label>
                    <select id="location" name="location" required class="mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                        <optgroup label="Countries">
                            <option value="US">ðŸ‡ºðŸ‡¸ United States</option>
                            <option value="GB">ðŸ‡¬ðŸ‡§ United Kingdom</option>
                            <option value="CA">ðŸ‡¨ðŸ‡¦ Canada</option>
                            <option value="AU">ðŸ‡¦ðŸ‡º Australia</option>
                            <option value="DE">ðŸ‡©ðŸ‡ª Germany</option>
                            <option value="FR">ðŸ‡«ðŸ‡· France</option>
                            <option value="JP">ðŸ‡¯ðŸ‡µ Japan</option>
                            <option value="BR">ðŸ‡§ðŸ‡· Brazil</option>
                            <option value="IN">ðŸ‡®ðŸ‡³ India</option>
                            <option value="ZA">ðŸ‡¿ðŸ‡¦ South Africa</option>
                            <option value="TR">ðŸ‡¹ðŸ‡· Turkey</option>
                        </optgroup>
                        <optgroup label="US States">
                            <option value="US-AL">Alabama</option>
                            <option value="US-AK">Alaska</option>
                            <option value="US-AZ">Arizona</option>
                            <option value="US-AR">Arkansas</option>
                            <option value="US-CA">California</option>
                            <option value="US-CO">Colorado</option>
                            <option value="US-CT">Connecticut</option>
                            <option value="US-DE">Delaware</option>
                            <option value="US-FL">Florida</option>
                            <option value="US-GA">Georgia</option>
                            <option value="US-HI">Hawaii</option>
                            <option value="US-ID">Idaho</option>
                            <option value="US-IL">Illinois</option>
                            <option value="US-IN">Indiana</option>
                            <option value="US-IA">Iowa</option>
                            <option value="US-KS">Kansas</option>
                            <option value="US-KY">Kentucky</option>
                            <option value="US-LA">Louisiana</option>
                            <option value="US-ME">Maine</option>
                            <option value="US-MD">Maryland</option>
                            <option value="US-MA">Massachusetts</option>
                            <option value="US-MI">Michigan</option>
                            <option value="US-MN">Minnesota</option>
                            <option value="US-MS">Mississippi</option>
                            <option value="US-MO">Missouri</option>
                            <option value="US-MT">Montana</option>
                            <option value="US-NE">Nebraska</option>
                            <option value="US-NV">Nevada</option>
                            <option value="US-NH">New Hampshire</option>
                            <option value="US-NJ">New Jersey</option>
                            <option value="US-NM">New Mexico</option>
                            <option value="US-NY">New York</option>
                            <option value="US-NC">North Carolina</option>
                            <option value="US-ND">North Dakota</option>
                            <option value="US-OH">Ohio</option>
                            <option value="US-OK">Oklahoma</option>
                            <option value="US-OR">Oregon</option>
                            <option value="US-PA">Pennsylvania</option>
                            <option value="US-RI">Rhode Island</option>
                            <option value="US-SC">South Carolina</option>
                            <option value="US-SD">South Dakota</option>
                            <option value="US-TN">Tennessee</option>
                            <option value="US-TX">Texas</option>
                            <option value="US-UT">Utah</option>
                            <option value="US-VT">Vermont</option>
                            <option value="US-VA">Virginia</option>
                            <option value="US-WA">Washington</option>
                            <option value="US-WV">West Virginia</option>
                            <option value="US-WI">Wisconsin</option>
                            <option value="US-WY">Wyoming</option>
                        </optgroup>
                    </select>
                </div>
                <div>
                    <label for="category" class="block text-sm font-medium text-gray-700">Select Category:</label>
                    <select id="category" name="category" required class="mt-1 block w-full py-2 px-3 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm">
                        <option value="">Select a category</option>
                        <optgroup label="Automotive">
                            <option value="car_dealer">Car Dealer</option>
                            <option value="car_rental">Car Rental</option>
                            <option value="car_repair">Car Repair</option>
                            <option value="car_wash">Car Wash</option>
                            <option value="electric_vehicle_charging_station">Electric Vehicle Charging Station</option>
                            <option value="gas_station">Gas Station</option>
                            <option value="parking">Parking</option>
                            <option value="rest_stop">Rest Stop</option>
                        </optgroup>
                        <optgroup label="Business">
                            <option value="farm">Farm</option>
                        </optgroup>
                        <optgroup label="Culture">
                            <option value="art_gallery">Art Gallery</option>
                            <option value="museum">Museum</option>
                            <option value="performing_arts_theater">Performing Arts Theater</option>
                        </optgroup>
                        <optgroup label="Education">
                            <option value="library">Library</option>
                            <option value="preschool">Preschool</option>
                            <option value="primary_school">Primary School</option>
                            <option value="school">School</option>
                            <option value="secondary_school">Secondary School</option>
                            <option value="university">University</option>
                        </optgroup>
                        <optgroup label="Entertainment and Recreation">
                            <option value="amusement_center">Amusement Center</option>
                            <option value="amusement_park">Amusement Park</option>
                            <option value="aquarium">Aquarium</option>
                            <option value="banquet_hall">Banquet Hall</option>
                            <option value="bowling_alley">Bowling Alley</option>
                            <option value="casino">Casino</option>
                            <option value="community_center">Community Center</option>
                            <option value="convention_center">Convention Center</option>
                            <option value="cultural_center">Cultural Center</option>
                            <option value="dog_park">Dog Park</option>
                            <option value="event_venue">Event Venue</option>
                            <option value="hiking_area">Hiking Area</option>
                            <option value="historical_landmark">Historical Landmark</option>
                            <option value="marina">Marina</option>
                            <option value="movie_rental">Movie Rental</option>
                            <option value="movie_theater">Movie Theater</option>
                            <option value="national_park">National Park</option>
                            <option value="night_club">Night Club</option>
                            <option value="park">Park</option>
                            <option value="tourist_attraction">Tourist Attraction</option>
                            <option value="visitor_center">Visitor Center</option>
                            <option value="wedding_venue">Wedding Venue</option>
                            <option value="zoo">Zoo</option>
                        </optgroup>
                        <optgroup label="Finance">
                            <option value="accounting">Accounting</option>
                            <option value="atm">ATM</option>
                            <option value="bank">Bank</option>
                        </optgroup>
                        <optgroup label="Food and Drink">
                            <option value="american_restaurant">American Restaurant</option>
                            <option value="bakery">Bakery</option>
                            <option value="bar">Bar</option>
                            <option value="barbecue_restaurant">Barbecue Restaurant</option>
                            <option value="brazilian_restaurant">Brazilian Restaurant</option>
                            <option value="breakfast_restaurant">Breakfast Restaurant</option>
                            <option value="brunch_restaurant">Brunch Restaurant</option>
                            <option value="cafe">Cafe</option>
                            <option value="chinese_restaurant">Chinese Restaurant</option>
                            <option value="coffee_shop">Coffee Shop</option>
                            <option value="fast_food_restaurant">Fast Food Restaurant</option>
                            <option value="french_restaurant">French Restaurant</option>
                            <option value="greek_restaurant">Greek Restaurant</option>
                            <option value="hamburger_restaurant">Hamburger Restaurant</option>
                            <option value="ice_cream_shop">Ice Cream Shop</option>
                            <option value="indian_restaurant">Indian Restaurant</option>
                            <option value="indonesian_restaurant">Indonesian Restaurant</option>
                            <option value="italian_restaurant">Italian Restaurant</option>
                            <option value="japanese_restaurant">Japanese Restaurant</option>
                            <option value="korean_restaurant">Korean Restaurant</option>
                            <option value="lebanese_restaurant">Lebanese Restaurant</option>
                            <option value="meal_delivery">Meal Delivery</option>
                            <option value="meal_takeaway">Meal Takeaway</option>
                            <option value="mediterranean_restaurant">Mediterranean Restaurant</option>
                            <option value="mexican_restaurant">Mexican Restaurant</option>
                            <option value="middle_eastern_restaurant">Middle Eastern Restaurant</option>
                            <option value="pizza_restaurant">Pizza Restaurant</option>
                            <option value="ramen_restaurant">Ramen Restaurant</option>
                            <option value="restaurant">Restaurant</option>
                            <option value="sandwich_shop">Sandwich Shop</option>
                            <option value="seafood_restaurant">Seafood Restaurant</option>
                            <option value="spanish_restaurant">Spanish Restaurant</option>
                            <option value="steak_house">Steak House</option>
                            <option value="sushi_restaurant">Sushi Restaurant</option>
                            <option value="thai_restaurant">Thai Restaurant</option>
                            <option value="turkish_restaurant">Turkish Restaurant</option>
                            <option value="vegan_restaurant">Vegan Restaurant</option>
                            <option value="vegetarian_restaurant">Vegetarian Restaurant</option>
                            <option value="vietnamese_restaurant">Vietnamese Restaurant</option>
                        </optgroup>
                        <optgroup label="Geographical Areas">
                            <option value="administrative_area_level_1">Administrative Area Level 1</option>
                            <option value="administrative_area_level_2">Administrative Area Level 2</option>
                            <option value="country">Country</option>
                            <option value="locality">Locality</option>
                            <option value="postal_code">Postal Code</option>
                            <option value="school_district">School District</option>
                        </optgroup>
                        <optgroup label="Government">
                            <option value="city_hall">City Hall</option>
                            <option value="courthouse">Courthouse</option>
                            <option value="embassy">Embassy</option>
                            <option value="fire_station">Fire Station</option>
                            <option value="local_government_office">Local Government Office</option>
                            <option value="police">Police</option>
                            <option value="post_office">Post Office</option>
                        </optgroup>
                        <optgroup label="Health and Wellness">
                            <option value="dental_clinic">Dental Clinic</option>
                            <option value="dentist">Dentist</option>
                            <option value="doctor">Doctor</option>
                            <option value="drugstore">Drugstore</option>
                            <option value="hospital">Hospital</option>
                            <option value="medical_lab">Medical Lab</option>
                            <option value="pharmacy">Pharmacy</option>
                            <option value="physiotherapist">Physiotherapist</option>
                            <option value="spa">Spa</option>
                        </optgroup>
                        <optgroup label="Lodging">
                            <option value="bed_and_breakfast">Bed and Breakfast</option>
                            <option value="campground">Campground</option>
                            <option value="hostel">Hostel</option>
                            <option value="hotel">Hotel</option>
                            <option value="camping_cabin">Camping Cabin</option>
                            <option value="cottage">Cottage</option>
                            <option value="extended_stay_hotel">Extended Stay Hotel</option>
                            <option value="farmstay">Farmstay</option>
                            <option value="guest_house">Guest House</option>
                            <option value="lodging">Lodging</option>
                            <option value="motel">Motel</option>
                            <option value="private_guest_room">Private Guest Room</option>
                            <option value="resort_hotel">Resort Hotel</option>
                            <option value="rv_park">RV Park</option>
                        </optgroup>
                        <optgroup label="Places of Worship">
                            <option value="church">Church</option>
                            <option value="hindu_temple">Hindu Temple</option>
                            <option value="mosque">Mosque</option>
                            <option value="synagogue">Synagogue</option>
                        </optgroup>
                        <optgroup label="Services">
                            <option value="barber_shop">Barber Shop</option>
                            <option value="beauty_salon">Beauty Salon</option>
                            <option value="cemetery">Cemetery</option>
                            <option value="child_care_agency">Child Care Agency</option>
                            <option value="consultant">Consultant</option>
                            <option value="courier_service">Courier Service</option>
                            <option value="electrician">Electrician</option>
                            <option value="florist">Florist</option>
                            <option value="funeral_home">Funeral Home</option>
                            <option value="hair_care">Hair Care</option>
                            <option value="hair_salon">Hair Salon</option>
                            <option value="insurance_agency">Insurance Agency</option>
                            <option value="laundry">Laundry</option>
                            <option value="lawyer">Lawyer</option>
                            <option value="locksmith">Locksmith</option>
                            <option value="moving_company">Moving Company</option>
                            <option value="painter">Painter</option>
                            <option value="plumber">Plumber</option>
                            <option value="real_estate_agency">Real Estate Agency</option>
                            <option value="roofing_contractor">Roofing Contractor</option>
                            <option value="storage">Storage</option>
                            <option value="tailor">Tailor</option>
                            <option value="telecommunications_service_provider">Telecommunications Service Provider</option>
                            <option value="travel_agency">Travel Agency</option>
                            <option value="veterinary_care">Veterinary Care</option>
                        </optgroup>
                        <optgroup label="Shopping">
                            <option value="auto_parts_store">Auto Parts Store</option>
                            <option value="bicycle_store">Bicycle Store</option>
                            <option value="book_store">Book Store</option>
                            <option value="cell_phone_store">Cell Phone Store</option>
                            <option value="clothing_store">Clothing Store</option>
                            <option value="convenience_store">Convenience Store</option>
                            <option value="department_store">Department Store</option>
                            <option value="discount_store">Discount Store</option>
                            <option value="electronics_store">Electronics Store</option>
                            <option value="furniture_store">Furniture Store</option>
                            <option value="gift_shop">Gift Shop</option>
                            <option value="grocery_store">Grocery Store</option>
                            <option value="hardware_store">Hardware Store</option>
                            <option value="home_goods_store">Home Goods Store</option>
                            <option value="home_improvement_store">Home Improvement Store</option>
                            <option value="jewelry_store">Jewelry Store</option>
                            <option value="liquor_store">Liquor Store</option>
                            <option value="market">Market</option>
                            <option value="pet_store">Pet Store</option>
                            <option value="shoe_store">Shoe Store</option>
                            <option value="shopping_mall">Shopping Mall</option>
                            <option value="sporting_goods_store">Sporting Goods Store</option>
                            <option value="store">Store</option>
                            <option value="supermarket">Supermarket</option>
                            <option value="wholesaler">Wholesaler</option>
                        </optgroup>
                        <optgroup label="Sports">
                            <option value="athletic_field">Athletic Field</option>
                            <option value="fitness_center">Fitness Center</option>
                            <option value="golf_course">Golf Course</option>
                            <option value="ski_resort">Ski Resort</option>
                            <option value="sports_club">Sports Club</option>
                            <option value="sports_complex">Sports Complex</option>
                            <option value="gym">Gym</option>
                            <option value="playground">Playground</option>
                            <option value="stadium">Stadium</option>
                            <option value="swimming_pool">Swimming Pool</option>
                        </optgroup>
                        <optgroup label="Transportation">
                            <option value="airport">Airport</option>
                            <option value="bus_station">Bus Station</option>
                            <option value="bus_stop">Bus Stop</option>
                            <option value="ferry_terminal">Ferry Terminal</option>
                            <option value="heliport">Heliport</option>
                            <option value="light_rail_station">Light Rail Station</option>
                            <option value="park_and_ride">Park and Ride</option>
                            <option value="subway_station">Subway Station</option>
                            <option value="taxi_stand">Taxi Stand</option>
                            <option value="train_station">Train Station</option>
                            <option value="transit_depot">Transit Depot</option>
                            <option value="transit_station">Transit Station</option>
                            <option value="truck_stop">Truck Stop</option>
                        </optgroup>
                    </select>
                </div>
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700">Search Type:</label>
                    <div class="mt-2">
                        <label class="inline-flex items-center">
                            <input type="radio" class="form-radio" name="search-type" value="specific-location" checked>
                            <span class="ml-2">List Locations</span>
                        </label>
                        <label class="inline-flex items-center">
                            <input type="radio" class="form-radio" name="search-type" value="state-count">
                            <span class="ml-2">Count Locations by US States(50)</span>
                        </label>
                        <label class="inline-flex items-center">
                            <input type="radio" class="form-radio" name="search-type" value="specific-count">
                            <span class="ml-2">Count Locations by Specific Loc</span>
                        </label>
                    </div>
                    
                    <div id="deep-search-container" class="mb-4 hidden">
                        <label class="inline-flex items-center">
                            <input type="checkbox" class="form-checkbox" name="use-deep-search" value="true">
                            <span class="ml-2">Use Deep Search (may take longer)</span>
                        </label>
                    </div>
    
                </div>
                <button type="submit" class="w-full bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
                    Search
                </button>
            </form>
            <div id="status" class="mt-4 text-center hidden">
                <p class="text-indigo-600 font-semibold animate-pulse">Processing... Please wait</p>
            </div>
            <div id="download-container" class="mt-4 text-center hidden">
                <a href="/download-csv" class="inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500">
                    Download Results
                </a>
            </div>
        </div>
    </main>


    <footer class="bg-gray-800 text-white py-4 text-center">
        <p class="flex items-center justify-center">
            <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true">
                <path fill-rule="evenodd" d="M12 2C6.477 2 2 6.484 2 12.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0112 6.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.202 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.943.359.309.678.92.678 1.855 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0022 12.017C22 6.484 17.522 2 12 2z" clip-rule="evenodd" />
            </svg>
            Created by <a href="https://github.com/dorukanc" target="_blank" rel="noopener noreferrer" class="text-blue-400 hover:text-blue-300 ml-1">Dorukan</a>
        </p>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.21.1/axios.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            let currentSessionId = null;
            const form = document.getElementById('search-form');
            const status = document.getElementById('status');
            const downloadContainer = document.getElementById('download-container');
            const deepSearchContainer = document.getElementById('deep-search-container');

            // Toggle deep search visibility based on search type
            // Add specific count 
            function toggleDeepSearch() {
                const isStateCount = document.querySelector('input[name="search-type"]:checked').value === 'state-count' || document.querySelector('input[name="search-type"]:checked').value === 'specific-count';
                deepSearchContainer.classList.toggle('hidden', !isStateCount);
            }

            // Set up event listeners
            document.querySelectorAll('input[name="search-type"]').forEach(radio => radio.addEventListener('change', toggleDeepSearch));
            form.addEventListener('submit', handleSubmit);
            toggleDeepSearch();

            function handleSubmit(e) {
                e.preventDefault();
                status.classList.remove('hidden');
                downloadContainer.classList.add('hidden');

                fetch('/run-search', {
                    method: 'POST',
                    body: new FormData(form)
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        currentSessionId = data.session_id;
                        checkStatus();
                    } else {
                        status.textContent = 'Error: ' + data.message;
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    status.textContent = 'An error occurred. Please try again.';
                });
            }

            function checkStatus() {
                fetch(`/check-status/${currentSessionId}`)
                .then(response => response.json())
                .then(data => {
                    if (data.status === 'complete') {
                        status.classList.add('hidden');
                        downloadContainer.classList.remove('hidden');
                        document.querySelector('#download-container a').href = `/download-csv/${currentSessionId}`;
                    } else {
                        setTimeout(checkStatus, 5000);
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    status.textContent = 'An error occurred while checking status.';
                });
            }
        });
    </script>
</body>
</html>